{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n// import { onMounted } from \"vue\";\n\nconst __default__ = {\n  name: \"UserLogin\",\n  mounted() {\n    console.log(\"user login mounted\");\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      alert(\"Logout first\");\n      this.flag = true;\n      // this.$router.push(\"/admin_dashboard\");\n    }\n\n    if (this.flag && localStorage.getItem(\"role\") === \"user\") {\n      this.$router.push(\"/user_dashboard\");\n    }\n    // } else {\n    //   this.$router.push(\"/admin_login\");\n    // }\n  },\n\n  data() {\n    return {\n      email: \"\",\n      password: \"\",\n      username: \"\",\n      error: \"\",\n      error_message: \"\"\n    };\n  },\n  methods: {\n    submit: function () {\n      let data = {\n        email: this.email,\n        password: this.password,\n        username: this.username\n      };\n\n      // Initialize error and error_message\n      // eslint-disable-next-line\n      let error = false;\n      // eslint-disable-next-line\n      let error_message = \"\";\n      fetch(\"http://127.0.0.1:8000/login_user\", {\n        method: \"POST\",\n        body: JSON.stringify(data),\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }).then(response => response.json()).then(rdata => {\n        console.log(rdata);\n        if (rdata.access_token) {\n          localStorage.setItem(\"token\", rdata.access_token);\n          localStorage.setItem(\"role\", rdata.role);\n          localStorage.setItem(\"identity\", JSON.stringify({\n            email: rdata.identity.email,\n            id: rdata.identity.id,\n            username: rdata.identity.username\n          }));\n          const identityObject = JSON.parse(localStorage.getItem(\"identity\"));\n\n          // const id = identityObject.id;\n          const data = {\n            id: identityObject.id\n          };\n          fetch(\"http://127.0.0.1:8000/save_login_time\", {\n            method: \"POST\",\n            body: JSON.stringify(data),\n            headers: {\n              \"Content-Type\": \"application/json\"\n            }\n          }).catch(error => {\n            console.error(\"Fetch error:\", error);\n            // Handle the error or display it to the user\n          });\n\n          this.$router.push(\"/user_dashboard\");\n        } else {\n          this.error = true;\n          this.error_message = rdata.message;\n        }\n      });\n    }\n  }\n};\nexport default /*#__PURE__*/Object.assign(__default__, {\n  setup(__props) {\n    // /* eslint-disable */\n    // import { ref } from \"vue\";\n    // import axios from \"axios\";\n\n    // const email = ref(\"\");\n    // const password = ref(\"\");\n    // const error = ref(false);\n    // const error_message = ref(\"\");\n\n    // function onSubmit() {\n    //   // alert(`${email.value} ${password.value}`);\n    //   const url = \"http://127.0.0.1:8080/login\";\n    //   const data = {\n    //     email: email.value,\n    //     password: password.value,\n    //   };\n    //   const config = {\n    //     headers: {\n    //       \"Content-Type\": \"application/json\",\n    //     },\n    //   };\n\n    //   axios\n    //     .post(url, data, config)\n    //     .then((res) => {\n    //       console.log(res);\n    //       localStorage.setItem(\"token\", res.data.access_token);\n    //     })\n    //     .catch((err) => {\n    //       console.error(err);\n    //       error.value = true;\n    //       error_message.value = err.response.data.message;\n    //     });\n    // }\n\n    return {\n      __sfc: true\n    };\n  }\n});","map":{"version":3,"names":["__default__","name","mounted","console","log","token","localStorage","getItem","alert","flag","$router","push","data","email","password","username","error","error_message","methods","submit","fetch","method","body","JSON","stringify","headers","then","response","json","rdata","access_token","setItem","role","identity","id","identityObject","parse","catch","message"],"sources":["UserLogin.vue"],"sourcesContent":["<template>\n  <form @submit.prevent=\"submit\">\n    <div class=\"text-danger\" role=\"alert\" v-if=\"error\">\n      {{ error_message }}\n    </div>\n    <div class=\"mx-auto col-10 col-md-8 col-lg-6\">\n      <div class=\"form-group\">\n        <label for=\"email\">User Email Address</label>\n        <input\n          type=\"email\"\n          class=\"form-control mt-1\"\n          id=\"email\"\n          name=\"email\"\n          placeholder=\"Enter email\"\n          required\n          v-model=\"email\"\n        />\n      </div>\n      <div class=\"form-group\">\n        <label for=\"exampleInputPassword1\">User Password</label>\n        <input\n          type=\"password\"\n          class=\"form-control mt-1\"\n          id=\"exampleInputPassword1\"\n          placeholder=\"Password\"\n          name=\"password\"\n          required\n          v-model=\"password\"\n        />\n      </div>\n      <br />\n      <button class=\"btn btn-primary btn-lg btn-block\" type=\"submit\">\n        Login\n      </button>\n    </div>\n\n    <br />\n    <h5>\n      Are you new here? Register as\n      <router-link to=\"/user_reg\">User</router-link>\n    </h5>\n  </form>\n</template>\n\n<script setup>\n// /* eslint-disable */\n// import { ref } from \"vue\";\n// import axios from \"axios\";\n\n// const email = ref(\"\");\n// const password = ref(\"\");\n// const error = ref(false);\n// const error_message = ref(\"\");\n\n// function onSubmit() {\n//   // alert(`${email.value} ${password.value}`);\n//   const url = \"http://127.0.0.1:8080/login\";\n//   const data = {\n//     email: email.value,\n//     password: password.value,\n//   };\n//   const config = {\n//     headers: {\n//       \"Content-Type\": \"application/json\",\n//     },\n//   };\n\n//   axios\n//     .post(url, data, config)\n//     .then((res) => {\n//       console.log(res);\n//       localStorage.setItem(\"token\", res.data.access_token);\n//     })\n//     .catch((err) => {\n//       console.error(err);\n//       error.value = true;\n//       error_message.value = err.response.data.message;\n//     });\n// }\n</script>\n<script>\n// import { onMounted } from \"vue\";\n\nexport default {\n  name: \"UserLogin\",\n  mounted() {\n    console.log(\"user login mounted\");\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      alert(\"Logout first\");\n      this.flag = true;\n      // this.$router.push(\"/admin_dashboard\");\n    }\n    if (this.flag && localStorage.getItem(\"role\") === \"user\") {\n      this.$router.push(\"/user_dashboard\");\n    }\n    // } else {\n    //   this.$router.push(\"/admin_login\");\n    // }\n  },\n  data() {\n    return {\n      email: \"\",\n      password: \"\",\n      username: \"\",\n      error: \"\",\n      error_message: \"\",\n    };\n  },\n  methods: {\n    submit: function () {\n      let data = {\n        email: this.email,\n        password: this.password,\n        username: this.username,\n      };\n\n      // Initialize error and error_message\n      // eslint-disable-next-line\n      let error = false;\n      // eslint-disable-next-line\n      let error_message = \"\";\n\n      fetch(\"http://127.0.0.1:8000/login_user\", {\n        method: \"POST\",\n        body: JSON.stringify(data),\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      })\n        .then((response) => response.json())\n        .then((rdata) => {\n          console.log(rdata);\n\n          if (rdata.access_token) {\n            localStorage.setItem(\"token\", rdata.access_token);\n            localStorage.setItem(\"role\", rdata.role);\n            localStorage.setItem(\n              \"identity\",\n              JSON.stringify({\n                email: rdata.identity.email,\n                id: rdata.identity.id,\n                username: rdata.identity.username,\n              })\n            );\n            const identityObject = JSON.parse(localStorage.getItem(\"identity\"));\n\n            // const id = identityObject.id;\n            const data = { id: identityObject.id };\n            fetch(\"http://127.0.0.1:8000/save_login_time\", {\n              method: \"POST\",\n              body: JSON.stringify(data),\n              headers: {\n                \"Content-Type\": \"application/json\",\n              },\n            }).catch((error) => {\n              console.error(\"Fetch error:\", error);\n              // Handle the error or display it to the user\n            });\n            this.$router.push(\"/user_dashboard\");\n          } else {\n            this.error = true;\n            this.error_message = rdata.message;\n          }\n        });\n    },\n  },\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}